<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>hostlocal - v2.2.1</title><meta name="description" content="Documentation for hostlocal"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">hostlocal - v2.2.1</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>hostlocal - v2.2.1</h1></div><div class="tsd-panel tsd-typography"><h1 id="hostlocal" class="tsd-anchor-link">hostlocal<a href="#hostlocal" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Serve files from a directory over HTTP/1.1 and HTTP/2, with live reload
notifications over a websocket.  It will automatically create self-signed
certificates.</p>
<p>This server is quite opinionated about its defaults to make setup as easy
as possible... if you have a problem shaped like mine.</p>
<p>NOTE:</p>
<p>This server is NOT intended for production use, or any other place where the
clients are not fully-trusted.  Simplifying assumptions have been made to
optimize code size, performance, and usability that make its use in a
production context inappropriate.  Security issues that are filed that do
not take this note into account will not be prioritized.</p>
<h2 id="run" class="tsd-anchor-link">Run<a href="#run" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="sh"><span class="hl-0"># Serve the docs directory, and open index.html in your default browser.</span><br/><span class="hl-1">npx</span><span class="hl-2"> </span><span class="hl-3">hostlocal</span><span class="hl-2"> </span><span class="hl-3">docs</span>
</code><button type="button">Copy</button></pre>

<h2 id="cli" class="tsd-anchor-link">CLI<a href="#cli" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="text">Usage: hostlocal [options] [directory]

Arguments:
  directory                   Directory to serve. (default: cwd)

Options:
  -6, --ipv6                  Listen on IPv6 only, if host supports both IPv4
                              and IPv6.
  -c, --config &lt;file&gt;         If the given file exists, import it as a module
                              and use its default export as the options.  Name
                              is relative to cwd. Command line parameters
                              overwrite options from the config file. (default:
                              &quot;.hostlocal.js&quot;)
  --certDir &lt;directory&gt;       Directory, relative to cwd, to cache cert info.
                              (default: &quot;.cert&quot;)
  -e, --exec &lt;shell command&gt;  Execute this command when the glob changes.
                              (default: &quot;npm run build&quot;)
  -g, --glob &lt;pattern&gt;        Set of files to watch.  If one of these changes,
                              execute the command in the --exec option.  Can be
                              specified multiple times.
  -h, --help                  display help for command
  -H, --host &lt;address&gt;        Hostname or IP address to listen on. &quot;::&quot; for
                              everything. (default: &quot;localhost&quot;)
  -i, --initial               If glob is specified, run the exec command on
                              startup, before listening.
  --logFile &lt;file&gt;            If specified, JSON logs are written to this file.
  --no-script                 If specified, JavScript will not be added to the
                              end of HTML files to do auto-refresh.
  --notAfterDays &lt;number&gt;     How many days is the certificate valid? (default:
                              7)
  -o, --open &lt;path&gt;           Open this path in the default browser.  Relative
                              to server root and prefix, if specified.  If
                              empty (&quot;&quot;), do not open anything. (default: &quot;.&quot;)
  -O, --no-open               Do not open a page in the default browser.
  -p, --port &lt;number&gt;         Port to serve content from.  Use 0 to get an
                              unused port. (default: 8111)
  -P, --prefix &lt;string&gt;       Make all of the URLs served have paths that start
                              with this prefix, followed by a slash.
  -q, --quiet                 Do less logging.  Can be specified more than
                              once.
  --rawMarkdown               Do not process markdown into HTML.
  -t, --timeout &lt;number&gt;      Time, in ms, to allow exec to run.
  -v, --verbose               Do more logging.  Can be specified more than
                              once.
  -V, --version               output the version number
</code><button type="button">Copy</button></pre>

<h2 id="config-files" class="tsd-anchor-link">Config files<a href="#config-files" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Instead of using the command line, you can store your configuration in a
file, by default called &quot;.hostlocal.js&quot;.  This is an ES6 module with a default
export containing your config.  Its default value is:</p>
<pre><code class="js"><span class="hl-0">/**</span><br/><span class="hl-0"> * </span><span class="hl-4">@type</span><span class="hl-0"> </span><span class="hl-5">{import(&#39;./lib/index.js&#39;).HostOptions}</span><br/><span class="hl-0"> */</span><br/><span class="hl-6">export</span><span class="hl-2"> </span><span class="hl-6">default</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-7">certDir:</span><span class="hl-2"> </span><span class="hl-3">&#39;.cert&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">config:</span><span class="hl-2"> </span><span class="hl-3">&#39;.hostlocal.js&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">dir:</span><span class="hl-2"> </span><span class="hl-7">process</span><span class="hl-2">.</span><span class="hl-1">cwd</span><span class="hl-2">(),</span><br/><span class="hl-2">  </span><span class="hl-7">exec:</span><span class="hl-2"> </span><span class="hl-3">&#39;npm run build&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">CGI:</span><span class="hl-2"> {},</span><br/><span class="hl-2">  </span><span class="hl-7">glob:</span><span class="hl-2"> [],</span><br/><span class="hl-2">  </span><span class="hl-7">headers:</span><span class="hl-2"> {},</span><br/><span class="hl-2">  </span><span class="hl-7">host:</span><span class="hl-2"> </span><span class="hl-3">&#39;localhost&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">index:</span><span class="hl-2"> [</span><span class="hl-3">&#39;index.html&#39;</span><span class="hl-2">, </span><span class="hl-3">&#39;index.htm&#39;</span><span class="hl-2">, </span><span class="hl-3">&#39;README.md&#39;</span><span class="hl-2">],</span><br/><span class="hl-2">  </span><span class="hl-7">initial:</span><span class="hl-2"> </span><span class="hl-4">false</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">ipv6:</span><span class="hl-2"> </span><span class="hl-4">false</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">logLevel:</span><span class="hl-2"> </span><span class="hl-8">0</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">logFile:</span><span class="hl-2"> </span><span class="hl-4">null</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">notAfterDays:</span><span class="hl-2"> </span><span class="hl-8">7</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">open:</span><span class="hl-2"> </span><span class="hl-3">&#39;.&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">port:</span><span class="hl-2"> </span><span class="hl-8">8111</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">prefix:</span><span class="hl-2"> </span><span class="hl-3">&#39;&#39;</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">rawMarkdown:</span><span class="hl-2"> </span><span class="hl-4">false</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">script:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">signal:</span><span class="hl-2"> </span><span class="hl-4">null</span><span class="hl-2">,</span><br/><span class="hl-2">  </span><span class="hl-7">timeout:</span><span class="hl-2"> </span><span class="hl-4">null</span><span class="hl-2">,</span><br/><span class="hl-2">};</span>
</code><button type="button">Copy</button></pre>

<p>Command-line options take precedence over these.  Most of these match their
command line options for semantics.  Others:</p>
<ul>
<li><strong>dir</strong>: Serve this directory (tied to optional directory in CLI).</li>
<li><strong>CGI</strong>: Object containing a map from original mime type to <code>command</code>.  The
command is any shell command that emits at least a content-type header with
string CR/LF in the header.  <strong>NOTE:</strong> This feature has a high probability
of generating a security issue when you misconfigure it and allow external
access. This is an example that might work sometimes, but would be
catastrophic with untrusted inputs:</li>
</ul>
<pre><code class="json"><span class="hl-2">{</span><br/><span class="hl-2">  </span><span class="hl-9">&quot;CGI&quot;</span><span class="hl-2">: {</span><br/><span class="hl-2">    </span><span class="hl-9">&quot;application/x-httpd-php&quot;</span><span class="hl-2">: </span><span class="hl-3">&quot;php-cgi&quot;</span><br/><span class="hl-2">  }</span><br/><span class="hl-2">}</span>
</code><button type="button">Copy</button></pre>

<ul>
<li><strong>index</strong>: Array of strings for files to search for if a directory is requested.</li>
<li><strong>logLevel</strong>: The sum of the number of <code>-v</code> options (+1 each) an <code>-q</code> options
(-1 each).  -3: fatal, -2: error, -1: warn, 0: info, 1: debug, 2: trace.</li>
<li><strong>open</strong>: Specify <code>&quot;&quot;</code> or <code>false</code> to not open a file in the default browser.</li>
<li><strong>script</strong>: The opposite of the <code>--no-script</code> CLI option.</li>
<li><strong>signal</strong>: An abort signal that can be used to shut down the server as
cleanly as possible.</li>
</ul>
<h2 id="api" class="tsd-anchor-link">API<a href="#api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Full <a href="http://hildjj.github.io/hostlocal/">API documentation</a> is available.</p>
<p>Example:</p>
<pre><code class="js"><span class="hl-6">import</span><span class="hl-2"> {</span><span class="hl-7">hostLocal</span><span class="hl-2">} </span><span class="hl-6">from</span><span class="hl-2"> </span><span class="hl-3">&#39;hostlocal&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-4">const</span><span class="hl-2"> </span><span class="hl-10">server</span><span class="hl-2"> = </span><span class="hl-6">await</span><span class="hl-2"> </span><span class="hl-1">hostLocal</span><span class="hl-2">({</span><span class="hl-7">port:</span><span class="hl-2"> </span><span class="hl-8">8111</span><span class="hl-2">});</span><br/><span class="hl-4">const</span><span class="hl-2"> </span><span class="hl-10">url</span><span class="hl-2"> = </span><span class="hl-6">await</span><span class="hl-2"> </span><span class="hl-7">server</span><span class="hl-2">.</span><span class="hl-1">start</span><span class="hl-2">();</span>
</code><button type="button">Copy</button></pre>

<h2 id="unit-testing" class="tsd-anchor-link">Unit testing<a href="#unit-testing" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>For unit testing, you usually want to start up the server, wait for it to
start, then start making connections to it.  In order for those connections to
succeed, you need to trust the CA cert that got generated along the way.  This
currently requires a hack, but see
<a href="https://github.com/nodejs/node/issues/27079">Node.js Issue #27079</a> for
discussion of the right ways for this to be done in the future.  Here is some
code that works as of Node v24.1.0:</p>
<pre><code class="js"><span class="hl-6">import</span><span class="hl-2"> {</span><span class="hl-7">hostLocal</span><span class="hl-2">} </span><span class="hl-6">from</span><span class="hl-2"> </span><span class="hl-3">&#39;hostlocal&#39;</span><span class="hl-2">;</span><br/><br/><span class="hl-4">const</span><span class="hl-2"> </span><span class="hl-10">server</span><span class="hl-2"> = </span><span class="hl-6">await</span><span class="hl-2"> </span><span class="hl-1">hostLocal</span><span class="hl-2">({</span><span class="hl-7">port:</span><span class="hl-2"> </span><span class="hl-8">0</span><span class="hl-2">});</span><br/><span class="hl-4">const</span><span class="hl-2"> </span><span class="hl-10">url</span><span class="hl-2"> = </span><span class="hl-6">await</span><span class="hl-2"> </span><span class="hl-7">server</span><span class="hl-2">.</span><span class="hl-1">start</span><span class="hl-2">();</span><br/><br/><span class="hl-4">const</span><span class="hl-2"> </span><span class="hl-10">origCsC</span><span class="hl-2"> = </span><span class="hl-7">tls</span><span class="hl-2">.</span><span class="hl-7">createSecureContext</span><span class="hl-2">;</span><br/><span class="hl-0">// Use mockMethod if you want to reset this later.</span><br/><span class="hl-7">tls</span><span class="hl-2">.</span><span class="hl-1">createSecureContext</span><span class="hl-2"> = </span><span class="hl-7">options</span><span class="hl-2"> </span><span class="hl-4">=&gt;</span><span class="hl-2"> {</span><br/><span class="hl-2">  </span><span class="hl-4">const</span><span class="hl-2"> </span><span class="hl-10">secureContext</span><span class="hl-2"> = </span><span class="hl-1">origCsC</span><span class="hl-2">(</span><span class="hl-7">options</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-7">secureContext</span><span class="hl-2">.</span><span class="hl-7">context</span><span class="hl-2">.</span><span class="hl-1">addCACert</span><span class="hl-2">(</span><span class="hl-7">server</span><span class="hl-2">.</span><span class="hl-7">caCert</span><span class="hl-2">);</span><br/><span class="hl-2">  </span><span class="hl-6">return</span><span class="hl-2"> </span><span class="hl-7">secureContext</span><span class="hl-2">;</span><br/><span class="hl-2">};</span>
</code><button type="button">Copy</button></pre>

<hr>
<p><a href="https://github.com/hildjj/hostlocal/actions/workflows/node.js.yml"><img src="https://github.com/hildjj/hostlocal/actions/workflows/node.js.yml/badge.svg" alt="Tests"></a>
<a href="https://codecov.io/gh/hildjj/hostlocal"><img src="https://codecov.io/gh/hildjj/hostlocal/graph/badge.svg?token=HHS0QQ7NUF" alt="codecov"></a></p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#hostlocal"><span>hostlocal</span></a><ul><li><a href="#run"><span>Run</span></a></li><li><a href="#cli"><span>CLI</span></a></li><li><a href="#config-files"><span>Config files</span></a></li><li><a href="#api"><span>API</span></a></li><li><a href="#unit-testing"><span>Unit testing</span></a></li></ul></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://github.com/hildjj/hostlocal/">GitHub</a><a href="http://hildjj.github.io/hostlocal/">Documentation</a></nav><nav class="tsd-navigation"><a href="modules.html">hostlocal - v2.2.1</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
